import React, {Component} from 'react'import './CourierPanel.scss'import DeliveryPanel from './AdditionalComponents/DeliveryPanel'import OrdersList from './AdditionalComponents/OrdersList'import DeliveredOrder from './AdditionalComponents/DeliveredOrder/DeliveredOrder'import MiniPreloader from '../UI/Preloaders/MiniPrleloader'import {getDate} from '../../store/universalFunctions'export default class CourierPanel extends Component {    state = {        position: localStorage.getItem('position') ? JSON.parse(localStorage.getItem('position')) : '',        coordinate: localStorage.getItem('coordinate') ? JSON.parse(localStorage.getItem('coordinate')) : [],        positionIsValid: false,        errorMessage: ''    }    componentDidUpdate = async () => {        if (this.props.courierInfo.courierStatus > 0 && this.props.unsubscribeList.length === 0) {            await this.props.subscribeOrderInfo(this.props.courierInfo.id, this.props.courierInfo.courierStatus)        }    }    componentWillUnmount() {        this.props.unsubscribeAllOrders()    }    changePosition = async (position, coordinate, positionIsValid, errorMessage) => {        if (positionIsValid) {            this.setState({position, coordinate, errorMessage, positionIsValid})            localStorage.setItem('position', JSON.stringify(position))            localStorage.setItem('coordinate', JSON.stringify(coordinate))        }        else {            this.setState({positionIsValid, errorMessage})        }    }    increaseNumberElements = async () => {        if (!this.props.clEnd) {            const list = this.props.ordersList            await this.props.subscribeOrders(this.state.coordinate, list[list.length - 1].id, this.props.ordersList)        }    }    renderOrderInfo = (deliveredOrder) => {        return (            <ul className={'courier-panel__delivered-info'}>                <li className={'mb-15'}>Откуда: {deliveredOrder.name}</li>                <li className={'mb-15'}>Адресс доставки: {deliveredOrder.clientAddress}</li>                <li className={'mb-15'}>Стоимость доставки: {deliveredOrder.deliveryValue} ₽</li>                <li className={'mb-15'}>Имя клиента: {deliveredOrder.clientName}</li>                <li className={'mb-15'}>Контактный телефон: {deliveredOrder.clientNumberPhone}</li>                <li className={'mb-15'}>Время начала заказа: {getDate(deliveredOrder.startTime)}</li>                {                    deliveredOrder.orderValue                        ?                        <>                            <li className={'mb-15'}>Стоимость заказа: {deliveredOrder.orderValue} ₽</li>                            <li className={'mb-15'}>Стоимость доставки: {deliveredOrder.deliveryValue} ₽</li>                            <li className={'mb-15'}>                                <b>Итого: {parseInt(deliveredOrder.deliveryValue) + parseInt(deliveredOrder.orderValue)} ₽</b>                            </li>                        </>                        : null                }            </ul>        )    }    render() {        return (            <div className={'courier-panel'}>                {                    this.props.courierInfo.courierStatus === 0 || this.props.courierInfo.courierStatus === -1                        ? <OrdersList                            changePosition={this.changePosition}                            position={this.state.position}                            positionIsValid={this.state.positionIsValid}                            coordinate={this.state.coordinate}                            errorMessage={this.state.errorMessage}                            fetchOrderList={this.props.fetchOrderList}                            subscribeOrders={this.props.subscribeOrders}                            unsubscribeAllOrders={this.props.unsubscribeAllOrders}                            ordersList={this.props.ordersList}                            changeOrderData={this.props.changeOrderData}                            loading={this.props.loading}                            increaseNumberElements={this.increaseNumberElements}                        />                        : this.props.courierInfo.courierStatus === 1                        ? <DeliveredOrder                            ordersList={this.props.ordersList}                            interactWithPurchased={this.props.interactWithPurchased}                            renderOrderInfo={this.renderOrderInfo}                            changeOrderData={this.props.changeOrderData}                        />                        : this.props.courierInfo.courierStatus === 2                            ? <DeliveryPanel                                ordersList={this.props.ordersList}                                renderOrderInfo={this.renderOrderInfo}                                changeOrderData={this.props.changeOrderData}                                changePosition={this.changePosition}                                position={this.state.position}                                positionIsValid={this.state.positionIsValid}                                coordinate={this.state.coordinate}                                errorMessage={this.state.errorMessage}                                unsubscribeAllOrders={this.unsubscribeAllOrders}                            />                            : <MiniPreloader/>                }            </div>        )    }}// <div className={'dropdown'}>//     <div className="dropdown__content">//         <span className={'dropdown__item'}>Купил</span>//         <span className={'dropdown__item'}>Нет в наличии</span>//     </div>// </div>